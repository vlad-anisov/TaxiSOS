#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–°—Ç–∞—Ä—Ç" –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ SOSTaxi
# –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–Ω–æ–ø–∫–∏: [432,1984][647,2101]
# –¶–µ–Ω—Ç—Ä –∫–Ω–æ–ø–∫–∏: X=540, Y=2043

echo "üéØ –ù–∞–∂–∏–º–∞—é –∫–Ω–æ–ø–∫—É '–°—Ç–∞—Ä—Ç' –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ SOSTaxi..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
if ! adb devices | grep -q "device$"; then
    echo "‚ùå –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ!"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ
if ! adb shell dumpsys window | grep -q "com.example.sostaxi/.MainActivity"; then
    echo "üì± –ó–∞–ø—É—Å–∫–∞—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ SOSTaxi..."
    adb shell am start -n com.example.sostaxi/.MainActivity
    sleep 3
fi

# –ù–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É "–°—Ç–∞—Ä—Ç"
echo "üëÜ –ù–∞–∂–∏–º–∞—é –∫–Ω–æ–ø–∫—É '–°—Ç–∞—Ä—Ç' (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: 540, 2043)..."
adb shell input tap 540 2043

echo "‚úÖ –ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞! –ü—Ä–æ–≤–µ—Ä—è—é –ª–æ–≥–∏..."

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–≥–∏
sleep 2
adb logcat -s "MainActivity:*" "RtmpClient:*" "Camera2ApiManager:*" -d | tail -10

echo "üéâ –ì–æ—Ç–æ–≤–æ!" 